#The following macros are already defined in the program and can be used in the following
#   APP_NAME = the name of the folder you run genSCPItemplate
#   TOP = the full directory of the folder you run genSCPItemplate

# EPICS_BASE and ASYN are needed by makeSupport.pl either as ENV vars or defined here:
    EPICS_BASE = /Users/fdfuller/src/EPICS/base
    ASYN = /Users/fdfuller/src/EPICS/modules/asyn
# STREAM driver is required for SCPI stuff in the way we plan to do it
    STREAM = /Users/fdfuller/src/EPICS/modules/streams
# This script will create an ioc application with name $(APP_NAME)$(APP_SUFFIX).  
# By default the suffix is empty but if you want one set it here:
    APP_SUFFIX = 
    

@ $(TOP)/configure/RELEASE {
    ensure EPICS_BASE = $(EPICS_BASE) 
    ensure ASYN = $(ASYN) before <# EPICS_BASE>
    ensure STREAM = $(STREAM) #before <# EPICS_BASE>
}

@ $(TOP)/configure/CONFIG_SITE {
    ensure CROSS_COMPILER_TARGET_ARCHS = $[] after <CROSS_COMPILER_TARGET_ARCHS>  #$[] will be replaced by empty string
}

@ $(TOP)/$(APP_NAME)Sup/Makefile {
    ensure DB_INSTALLS += $(TOP)/$(APP_NAME)Sup/dev$(APP_NAME).proto
}

@ $(TOP)/$(APP_NAME)$(APP_SUFFIX)App/src/Makefile {
    ensure $(APP_NAME)$(APP_SUFFIX)_DBD  += stream.dbd              after <will be made up from these files> 
    ensure $(APP_NAME)$(APP_SUFFIX)_DBD  += drvAsynSerialPort.dbd   after <will be made up from these files>
    ensure $(APP_NAME)$(APP_SUFFIX)_DBD  += asyn.dbd                after <will be made up from these files>
    ensure $(APP_NAME)$(APP_SUFFIX)_LIBS += stream                  after <support libraries needed by> 
    ensure $(APP_NAME)$(APP_SUFFIX)_LIBS += asyn                    after <support libraries needed by>
}

#@ $(TOP)/$(APP_NAME)$(APP_SUFFIX)App/Db/Makefile {
    #ensure DB_INSTALLS += $(ASYN)/db/asynRecord.db
#}

@ $(TOP)/st.cmd {
    define P = x
    define R = x
    define TTY = /dev/cu.usbserial-FTWDR32T
    define BAUD = 9600
    define BITS = 8
    define PARITY = none
    define STOP = 1
}

@ $(TOP)/dev$(APP_NAME).db {
    define APP_NAME = $(APP_NAME)
}
